---
layout: post
title: "深入理解 Classifier-Free Guidance"
date: 2025-02-20
categories: [深度学习, 生成式AI]
tags: [CFG, Diffusion Models, 条件生成]
---

## 什么是 CFG?

Classifier-Free Guidance (CFG) 是一种改进的条件生成技术...

## 核心原理

CFG 的核心思想是在训练时同时学习条件模型和无条件模型...

```python
def cfg_sampling(model, condition, guidance_scale=7.5):
    # 条件预测
    cond_pred = model(x_t, t, condition)
    # 无条件预测
    uncond_pred = model(x_t, t, None)
    # CFG 公式
    pred = uncond_pred + guidance_scale * (cond_pred - uncond_pred)
    return pred
```

## 实验结果

在 CelebA-64 数据集上的实验表明...